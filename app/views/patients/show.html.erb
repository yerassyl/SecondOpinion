<%= render 'layouts/messages' %>
<div class="patient">

<div class="row profile">
  <h2> Personal Details </h2>
  <!-- Profile image -->
  <div class="small-3 large-3 columns">
    Personal profile image ???
  </div>

  <!-- Profile short information -->
  <div class="small-9 large-9 columns">

    <div class="row profile-info">

      <div class="small-8 large-8 columns">
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.firstname'), value: @patient.firstname %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.lastname'), value:@patient.lastname %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.middlename'), value:@patient.middlename %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.date_of_birth'), value:@patient.birthday %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.maritial_status'), value:@patient.maritial_status %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.gender'), value:@patient.print_gender %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.telephone'), value:@patient.telephone %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.cellphone'), value:@patient.cellphone %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.emergency_person'), value:@patient.emergency_person %>
        <%= render 'layouts/profile/profile_info_instance', info_label:t('personal_details.emergency_person_phone'), value:@patient.emergency_person_phone %>
      </div>

      <div class="small-4 large-4 columns">

      </div>

    </div>

  </div>

</div>

<div class="row">

  <div class="small-3 large-3 columns medical-history">
      <h3 class="headings">Allergies</h3>
      <%= react_component('AllergyBox', {url_get: allergies_patients_path,
                                         url_post: create_allergy_patients_path,
                                         url_delete: delete_allergy_patients_path,
                                          patient_id: @patient.id}) %>

      <h3 class="headings">Diseases</h3>
      <%= react_component('DiseaseBox',{
          url_get: diseases_patients_path,
          url_post: create_disease_patients_path,
          url_delete: delete_disease_patients_path,
          patient_id: @patient.id
      }) %>

    </div>

    <div class="small-9 large-9 columns">

      <div class="row">
        <div class="small-12 large-12 columns">
          <span><%= link_to 'New Medical Situation', '#',class:'button success tiny', id:'new_med_situation_btn' %>
          </span>
          <%= render 'medical_situation_form' %>
        </div>
      </div>


        <% @medical_situations.each do |medical_situation| %>

          <div class="row medical_situation">
            <div class="small-12 large-12 columns">

              <div class="row">
                  <div class="small-12 large-12 columns">
                    <span class="fr heading">date opened: <%= medical_situation.created_at.to_date %></span>
                  </div>
              </div>


              <div class="row">
                <div class="small-3 large-2 columns">
                  <span class="heading"><%= t('patient_module.medical_history.reason') %></span>
                </div>
                <div class="small-9 large-10 columns">
                  <span class="reason"><%= medical_situation.reason %></span>
                </div>
              </div>

              <div class="row">

                <div class="small-4 large-4 columns">
                  <h4 class="headings"><%= "#{t('nouns.plural.medications')} #{t('verbs.taking')}" %></h4>
                  <% if medical_situation.medications.present? %>
                      <ul>
                        <% medical_situation.medications.each do |medication| %>
                        <li>
                          <span class="heading"><%= t('nouns.singular.medication')%>:</span> <%= medication.name %><br>
                          <span class="heading"><%= t('patient_module.medical_history.medication.dose')%>:</span> <%= medication.dose %> |
                          <span class="heading"><%= t('patient_module.medical_history.medication.frequency')%>:</span> <%= medication.per_day %> <%= t('patient_module.medical_history.medication.times') %><br>
                          <span class="heading"><%= t('patient_module.medical_history.other')%>:</span> <%= medication.other %>
                        </li>
                        <% end %>
                      </ul>
                  <% end %>
                </div>

                <div class="small-4 large-4 columns">
                  <h4 class="headings"><%= t('nouns.plural.lab_tests')%></h4>
                  <% if medical_situation.lab_tests.present? %>
                      <ul>
                      <% medical_situation.lab_tests.each do |lab_test| %>
                        <li>
                          <span class="heading"><%= t('personal_details.name')%>:</span> <%= lab_test.name %> <br>
                          <span class="heading"><%= t('nouns.singular.description')%>:</span> <%= lab_test.description %><br>
                          <span class="heading"><%= t('file')%></span> <%= link_to t('open'), lab_test.file.url, {target:'_blank'} %>
                        </li>
                      <% end %>
                  <% end %>
                      </ul>
                </div>

                <div class="small-4 large-4 columns">
                  <h4 class="headings"><%= t('nouns.plural.other_documents')%></h4>
                  <% if medical_situation.other_documents.present? %>
                    <ul>
                      <% medical_situation.other_documents.each do |other_document| %>
                        <li>
                          <span class="heading"><%= t('personal_details.name')%>:</span> <%= other_document.name %><br>
                          <span class="heading"><%= t('nouns.singular.description')%></span> <%= other_document.description %><br>
                          <span class="heading"><%= t('file')%>: </span> <%=link_to t('open'), other_document.file.url %>
                        </li>
                      <% end %>
                    </ul>
                  <% end %>
                </div>

              </div>

            </div>
          </div>

        <% end %>



    </div>
</div>

</div>